\chapter{Composition of Rotors in terms of their Generators}
\label{cha:bch}

In studying proper orthogonal transformations, it is often easier to represent them in terms of their generators $Ïƒ_i âˆˆ \GA(p,q)$ which belong to the Lie algebra $\liealg{so}(p,q)$.
A fundamental question is how such transformations compose in terms of these generators: ``given $Ïƒ_1$ and $Ïƒ_2$, what is $Ïƒ_3$ such that $e^{Ïƒ_1}e^{Ïƒ_2} = e^{Ïƒ_3}$?''
This is of theoretical interest and is useful practically when representing transformations in terms of their generators is cheaper.
One may use the \x{BCH full}\sidenote{
	Often simply Baker--Campbell--Hausdorff and permutations thereof.
} (\x{BCH}) formula $\bch{Ïƒ_1}{Ïƒ_2} â‰” \log(e^{Ïƒ_1}e^{Ïƒ_2})$ which is well studied in general Lie theory \cite{achilles2012bch-early}.
However, the general \x{BCH} formula
\begin{align}
	\bch{a}{b} = a + b + \frac12[a, b] + \frac{1}{12}[a, [a, b]] + \frac{1}{12}[[a, b], b] + \cdots
	\label{eqn:general-BCH-formula}
\end{align}
involves an infinite series of nested commutators and may not obviously admit a useful closed form.

In the case of Lorentz transformations $\SO^+(1,3)$, some closed-form expressions for \cref{eqn:general-BCH-formula} have been found using a $2$-form representation of $\liealg{so}(1,3)$ \cite{coll2002sr-generator-composition,coll1990sr-generator-exponentiation}, but the expressions are complicated and do not clearly reduce to well-known formulae in, for example, the special cases of pure rotations or pure boosts.
The rotor formalism of geometric algebra leads to an elegant closed form of \cref{eqn:general-BCH-formula} which, in the case of Lorentzian spacetime, is inexpensive to compute.




\section{A Geometric \x{BCH} Formula}
\label{sec:bch-derivation}

Suppose $Ïƒ âˆˆ \GA[2](p, q)$ is a bivector in a geometric algebra of dimension $p + q â‰¤ 4$.
By their definitions as formal power series, we have
\begin{math}
	e^{Ïƒ} = \cosh Ïƒ + \sinh Ïƒ
,\end{math}
where `$\cosh$' involves even powers of $Ïƒ$ and `$\sinh$' odd powers.
For convenience, define the linear projections onto \textdef{self-reverse} and \textdef{anti-self-reverse} parts respectively as
\begin{align}
	\srev{A} &â‰” \frac12\qty(A + \rev{A})
&	&\text{and}
&	\arev{A} &â‰” \frac12\qty(A - \rev{A})
	\label{eqn:rev-notation}
.\end{align}
Since any bivector obeys $\rev{Ïƒ} = -Ïƒ$, it follows that $\rev{(e^Ïƒ)} = e^{-Ïƒ} = \cosh Ïƒ - \sinh Ïƒ$.
Using the notation \eqref{eqn:rev-notation}, the self-reverse and anti-self-reverse projections of $e^Ïƒ$ are $\srev{e^{Ïƒ}} = \cosh Ïƒ$ and $\arev{e^{Ïƒ}} = \sinh Ïƒ$, respectively.
Furthermore, these two projections commute, and so
\begin{align}
	{\arev{e^{Ïƒ}}}{\srev{e^{Ïƒ}}}^{-1}
	= {\srev{e^{Ïƒ}}}^{-1}{\arev{e^{Ïƒ}}}
	= \frac{\arev{e^{Ïƒ}}}{\srev{e^{Ïƒ}}}
	= \tanh Ïƒ
\end{align}
which leads to an expression for the logarithm of any rotor $\rotor R = Â± e^Ïƒ$.
\begin{align}
	Ïƒ = \log(\rotor R) = \arctanh\qty(\frac{\arev{\rotor R}}{\srev{\rotor R}})
	\label{eqn:log-rotor}
\end{align}
Note that the overall sign of the rotor is not recovered, and $\log(+\rotor R) = \log(-\rotor R)$ according to \cref{eqn:log-rotor}.
However, this does not affect the Lorentz transformation $\lin R âˆˆ \SO^+(p, q)$, since it is defined by $R(ğ’–) = \rotor Rğ’–\rev{\rotor R}$.
The exact sign can be recovered by considering the relative signs of $\arev{\rotor R}$ and $\srev{\rotor R}$, as in \cite[Â§5.3]{lasenby2011ga-practical}.


From \cref{eqn:log-rotor} we may derive a \x{BCH} formula by substituting $\rotor R = e^{Ïƒ_1}e^{Ïƒ_2}$ for any two bivectors $Ïƒ_i âˆˆ \GA[2](p, q)$.
Using the shorthand $\Co{i} â‰” \cosh Ïƒ_i$ and $\Si{i} â‰” \sinh Ïƒ_i$, the composite rotor is
\begin{align}
	\rotor R = e^{Ïƒ_1}e^{Ïƒ_2}
	= (\Co1 + \Si1)(\Co2 + \Si2)
	= \Co1\Co2 + \Si1\Co2 + \Co1\Si1 + \Si1\Si2
.\end{align}
For $p + q < 4$, any even function of a bivector (such as $\Co{i}$) is a scalar, and for $p + q = 4$, is a $\qty{0,4}$-multivector $Î± + Î²\vol$.
In either case, the $\Co{i}$ commute with even multivectors, so $[\Co{i}, \Co{j}] = [\Co{i}, \Si{j}] = 0$.
Therefore, the self-reverse and anti-self-reverse parts are
\begin{align}
	\srev{\rotor R} &= \Co1\Co2 + \frac12\qty{\Si1, \Si2}
&	&\text{and}
&	\arev{\rotor R} &= \Si1\Co2 + \Co1\Si2 + \frac12\qty[\Si1, \Si2]
	\label{eqn:arev-and-srev-parts}
.\end{align}
Hence, from \cref{eqn:log-rotor} we obtain an explicit \x{BCH} formula.

\begin{theorem}[rotor \x{BCH} formula]
	\label{thm:geometric-BCH}
	If $Ïƒ_1, Ïƒ_2 âˆˆ \GA[2](p, q)$ are bivectors in $p + q â‰¤ 4$ dimensions, then $e^{Ïƒ_1}e^{Ïƒ_2} = Â±e^{\bch{Ïƒ_1}{Ïƒ_2}}$ where
	\begin{align}
		\label{eqn:geometric-BCH}
		\bch{Ïƒ_1}{Ïƒ_2}
		% \coloneqq \log(e^{Ïƒ_1}e^{Ïƒ_2})
		= \arctanh\qty(\frac{
			\Ta1 + \Ta2 + \frac12\qty[\Ta1, \Ta2]
		}{
			1 + \frac12\qty{\Ta1, \Ta2}
		})
	\end{align}
	where we abbreviate $\Ta{i} \coloneqq \tanh Ïƒ_i$.
	Note that this satisfies the rotor equation with an overall ambiguity in sign.
\end{theorem}

We may wish to express \cref{eqn:geometric-BCH} in terms of geometrically significant products instead of \paren{anti}commutators.
A bivector product is generally a $\qty{0,2,4}$-multivector
\begin{align}
	ab
	&= \grade[0]{ab} + \grade[2]{ab} + \grade[4]{ab}
\\	&= a \fatdot b + a Ã— b + a âˆ§ b
	\label{eqn:bivector-products}
.\end{align}
where $aÃ—b = \grade[2]{ab} = \frac12[a, b]$ is the commutator product.
We may then write \cref{eqn:geometric-BCH} so that the grade of each term is explicit:
\begin{align}
	\bch{Ïƒ_1}{Ïƒ_2} = \arctanh\qty(\frac{
		\Ta1 + \Ta2 + \Ta1 Ã— \Ta2
	}{
		1 + \Ta1 \fatdot \Ta2 + \Ta1 âˆ§ \Ta2 
	})
	\label{eqn:geometric-BCH-products}
\end{align}
The numerator is a bivector, while the denominator contains scalar ($\Ta1Â·\Ta2$) and $4$-vector ($\Ta1\wedge\Ta2$) terms.







\subsection{Zassenhaus-type formulae}

It is interesting to generalise the \x{BCH} formula \eqref{eqn:general-BCH-formula} to three rotors
\begin{math}
	e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3} = e^Ïƒ
\end{math}
in an algebra $\GA(p, q)$ with $p + q â‰¤ 4$.
A solution to this rotor equation is
\begin{align}
	Ïƒ = \log(Â±e^Ïƒ) = \arctanh\qty(\frac{\arev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}}{\srev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}})
,\end{align}
by \cref{eqn:log-rotor}.


We will find it convenient to define the \textdef{anticommutator product} $A\wedot B â‰” \frac12\qty{A, B}$ to complement the commutator product $AÃ—B$.
The symbol ``$\wedot$'' is motivated by the fact that, for bivectors, we have
\begin{math}
	Ïƒ\wedot Ï = Ïƒ\cdot Ï + Ïƒâˆ§Ï
\end{math}
and thus
\begin{align}
	\label{eqn:(anti)com-prods}
	Ïƒ\wedot Ï &â‰” \frac12(ÏƒÏ + ÏÏƒ) = \srev{ÏƒÏ}
,&	ÏƒÃ—Ï &â‰” \frac12(ÏƒÏ - ÏÏƒ) = \arev{ÏƒÏ}
.\end{align}





Because $e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3} âˆˆ \GA[+](p, q)$ is an even multivector, the anti-self-reverse projection is exactly the bivector part,
\begin{math}
	\arev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}} = \grade[2]{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}
,\end{math} and the self-reverse projection is the $\set{0,4}$-multivector part.\sidenote{
	Recall $\rev{A} = \revsign{k}A$ for a $k$-vector $A$ where $(\etc{\revsign{\i}}{}4) = (++--{})$.
}
Decomposing $e^{Ïƒ_i} = \Co i + \Si i$, we find $2^3$ terms which separate into%
\begin{fullwidth}
	\begin{align}
		\arev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}} &=
		% \grade[2]{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}} =
		\Si1\Co2\Co3 +
		\Co1\Si2\Co3 +
		\Co1\Co2\Si3 +
		(\Co1\Si2 + \Si1\Co2)Ã—\Si3 +
		(\Si1Ã—\Si2)\Co3 +
		\arev{\Si1\Si2\Si3} 
	,\\	\srev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}} &=
		% \grade[0,4]{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}} =
		\Co1\Co2\Co3 +
		(\Co1\Si2 + \Si1\Co2) \wedot \Si3 +
		(\Si1\wedot\Si2) \Co3 +
		\srev{\Si1\Si2\Si3}
	.\end{align}
\end{fullwidth}
The $\set{0,4}$-multivectors $\Co i$ commute with the bivectors $\Si i$, and products of $\Co i$ and $\Si j$ are themselves bivectors.
Therefore, terms containing one $\Si i$ factor are bivectors, and terms containing two $\Si i$ factors, such as $\Si1\Si2\Co3$, are products of bivectors, or $\set{0, 2, 4}$-multivectors.
These terms are split into bivectors $(\Si1Ã—\Si2)\Co3$ and $\set{0,4}$-multivectors $(\Si1\wedot\Si2)\Co3$.


Cancelling factors of $\Co1\Co2\Co3$, we then have
\begin{align}
	\label{eqn:ternary-bch.1}
	\frac{\arev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}}{\srev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}} =
	\frac{
		\Ta1 + \Ta2 + \Ta3 + (\Ta1 + \Ta2)Ã—\Ta3 + \Ta1 Ã— \Ta2 + \arev{\Ta1\Ta2\Ta3}
	}{
		1 + (\Ta1 + \Ta2)\wedot \Ta3 + \Ta1 \wedot \Ta2 + \srev{\Ta1\Ta2\Ta3}
	}
\end{align}
where $\Ta i â‰” \tanh Ïƒ_i$.
The next lemma is used to rewrite the rightmost terms with \paren{anti}commutator products \eqref{eqn:(anti)com-prods}.
\begin{lemma}
	For any bivectors $Ïƒ,Ï,Ï‰ âˆˆ \GA[2](p, q)$ where $p + q â‰¤ 4$,
	\begin{align}
		\arev{ÏƒÏÏ‰} &= (Ïƒ\wedotÏ)\wedotÏ‰ + (ÏƒÃ—Ï)Ã—Ï‰
	,&	\srev{ÏƒÏÏ‰} &= (ÏƒÃ—Ï)\wedotÏ‰
	.\end{align}
\end{lemma}
\begin{proof}
	Observe that $\arev{ÏƒÏÏ‰} = \grade[2]{ÏƒÏÏ‰}$ since $ÏƒÏÏ‰$ is a $\set{0, 2, 4}$-multivector, of which only the bivector part is anti-self-reverse.
	Using associativity and linearity,
	\begin{align}
		\grade[2]{ÏƒÏÏ‰} = \grade[2]{(Ïƒ\wedotÏ)Ï‰} + \grade[2]{(ÏƒÃ—Ï)Ï‰} = (Ïƒ\wedotÏ)Ï‰ + (ÏƒÃ—Ï)Ã—Ï‰
	.\end{align}
	The product $(Ïƒ\wedotÏ)Ï‰ = (Ïƒ\wedot Ï)\wedot Ï‰$ is between a $\set{0,4}$-multivector and a bivector, which may only contain bivector components.
	The product $(ÏƒÃ—Ï)Ï‰$ is between two bivectors, having bivector part $(ÏƒÃ—Ï)Ã—Ï‰$.

	Similarly, note that
	\begin{align}
		\srev{ÏƒÏÏ‰} = \grade[0,4]{(Ïƒ\wedotÏ)Ï‰} + \srev{(ÏƒÃ—Ï)Ï‰} = (ÏƒÃ—Ï)\wedotÏ‰
	,\end{align}
	where the first term vanishes since $(Ïƒ\wedotÏ)Ï‰$ is a bivector.
\end{proof}

This allows us to collect the terms in \cref{eqn:ternary-bch.1} as
{\begin{align}
	\frac{\arev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}}{\srev{e^{Ïƒ_1}e^{Ïƒ_2}e^{Ïƒ_3}}}
	% &= \frac{
	% 	(\Ta1 + \Ta2 + \Ta1 Ã— \Ta2) + \Ta3 + (\Ta1 + \Ta2 + \Ta1 Ã— \Ta2)Ã—\Ta3 + (\Ta1\wedot\Ta2)\wedot\Ta3
	% }{
	% 	1 + (\Ta1 + \Ta2 + \Ta1Ã—\Ta2)\wedot \Ta3 + \Ta1 \wedot \Ta2
	% }
	&= \frac{
		\Ta{12} + \Ta3 + \Ta{12}Ã—\Ta3 + (\Ta1\wedot\Ta2)\wedot\Ta3
	}{
		1 + \Ta{12}\wedot \Ta3 + \Ta1 \wedot \Ta2
	}
\end{align}}
where $\Ta{12} â‰” \Ta1 + \Ta2 + \Ta1Ã—\Ta2$.
This leads us to the following result.
\begin{lemma}
	For bivectors $Ïƒ_i âˆˆ \GA[2](p, q)$ with $p + q â‰¤ 4$,
	\begin{align}
		e^{Ïƒ_1 + Ïƒ_2} &= e^{Ïƒ_1}e^{Ïƒ_2}e^Ï
	\end{align}
	where
	\begin{align}
		Ï &= \arctanh\qty(\frac{
			F - R - RÃ—F + S\wedot F
		}{
			1 - R\wedot F + S
		})
	,\\	F &= \tanh(Ïƒ_1 + Ïƒ_2)
	,\\	R &= \tanh(Ïƒ_1)Ã—\tanh(Ïƒ_2) + \tanh(Ïƒ_1) + \tanh(Ïƒ_2)
	,\\	S &= \tanh(Ïƒ_1)\wedot\tanh(Ïƒ_2)
	.\end{align}
\end{lemma}

\todo{First order corrections? Donâ€™t know where to go with this.}









\subsection{In low dimensions: Rodrigues' rotation formula}

It is illustrative to see how the \x{BCH} formula \eqref{eqn:geometric-BCH} reduces in low-dimensional special cases.
Indeed, in two dimensions, all bivectors are scalar multiples of $\vol = \ve_1\ve_2$, and we recover the trivial case $e^ae^b = e^{a+b}$. %$\bch{a}{b} = a + b$.
Specifically, in the Euclidean $\GA(2)$ plane (or anti-Euclidean $\GA(0,2)$ plane) we have $\vol^2 = -1$, and \cref{eqn:geometric-BCH} simplifies by way of the tangent angle addition identity
\begin{align}
	\arctan(\frac{\tan Î¸_1 + \tan Î¸_1}{1 - \tan Î¸_1 \tan Î¸_2}) = Î¸_1 + Î¸_2
.\end{align}
This identity encodes how angles add when given as the gradients of lines; $m = \tan Î¸$.

Similarly, in the hyperbolic plane $\GA(1,1)$ with basis $\set{\ve_+, \ve_-}, \ve_Â±^2 = Â±1$, the pseudoscalar $\vol = \ve_+\ve_-$ generates \emph{hyperbolic} rotations $e^{\vol Î¾} = \cosh Î¾ + \vol\sinh Î¾$ owing to the fact that $\vol^2 = -\ve_+^2\ve_-^2 = +1$.
Then, \cref{eqn:geometric-BCH} simplifies by the hyperbolic angle addition identity
\begin{align}
	\arctanh\qty(\frac{\tanh Î¾_1 + \tanh Î¾_1}{1 + \tanh Î¾_1 \tanh Î¾_2}) = Î¾_1 + Î¾_2
\end{align}
which encodes how collinear rapidities add when given as relativistic velocities; $Î² = \tanh Î¾$.

Less trivially, a rotation in $\RR^3$ by $Î¸$ may be represented by its \textdef{Rodrigues vector}\sidenote{
	Olinde Rodrigues first originated the formula in 1840 \cite[pp. 406]{rodrigues1840rotations}.
} $\vb r = \vb{\hat{r}}\tan\fracÎ¸2$ pointing along the axis of rotation.
The composition of two rotations is then succinctly encoded in Rodrigues' composition formula
\begin{align}
	\vb r_{12} = \frac{\vb r_1 + \vb r_2 - \vb r_1 Ã— \vb r_2}{1 - \vb r_1 Â· \vb r_2}
	\label{eqn:rodrigues-formula}
\end{align}
involving the standard vector dot and cross products.

We can easily derive \cref{eqn:rodrigues-formula} as a special case of \cref{eqn:geometric-BCH-products} as follows:
Let $Ïƒ_1, Ïƒ_2 âˆˆ \GA[2](3)$ be two bivectors defining the rotors $e^{Ïƒ_1}$ and $e^{Ïƒ_2}$ in three dimensions.
In $\GA(3)$, the only $4$-vector is trivial, so $Ïƒ_1 âˆ§ Ïƒ_2 = 0$ and for the composite rotor $e^{Ïƒ_3} \coloneqq e^{Ïƒ_1}e^{Ïƒ_2}$ we have
\begin{align}
	Ïƒ_3 = \bch{Ïƒ_1}{Ïƒ_2} = \arctanh\qty(\frac{
	\tanh Ïƒ_1 + \tanh Ïƒ_2 + \tanh Ïƒ_1 \times \tanh Ïƒ_2
	}{
	1 + \tanh Ïƒ_1 Â· \tanh Ïƒ_2
	})
\end{align}
where $a Ã— b$ is the commutator product of bivectors as in \cref{eqn:bivector-products}, not the vector cross product.
Observe that Euclidean bivectors $Ïƒ_i âˆˆ \GA[2](3)$ have negative square (e.g., $(\ve_1\ve_2)^2 = -\ve_1^2\ve_2^2 = -1$) and relate to their dual normal vectors by $\vb{u}_i$ by $Ïƒ_i = \vb{u}_i\vol$.
Therefore, by rewriting
\begin{math}
	\tanh Ïƒ_i
	= \tanh (\vb{u}_i\vol)
	= (\tan \vb{u}_i)\vol
,\end{math}
we obtain the formula in terms of plain vectors and the vector cross product.
\begin{align}
	\vb{u}_{12} = (\bch{\vb{u}_1\vol}{\vb{u}_2\vol})\vol^{-1}
	= \arctan\qty(\frac{
	\tan \vb{u}_1 + \tan \vb{u}_2 - \tan \vb{u}_1 \times \tan \vb{u}_2
	}{
	1 - \tan \vb{u}_1 Â· \tan \vb{u}_2
	})
\end{align}
Indeed, a bivector $Ïƒ_i = \vb{u}_i\vol$ generates an $\RR^3$ rotation through an angle $Î¸ = 2\|\vb{u}_i\|$ via the double-sided transformation law
\begin{math}
	a \mapsto e^{\vb{u}\vol}ae^{-\vb{u}\vol}
.\end{math}
Hence, $\tan \vb{u}_i = \vb{\hat{v}}_i\tan\fracÎ¸2 â‰¡ \vb{r}_i$ are exactly the half-angle Rodrigues vectors, and we recover \cref{eqn:rodrigues-formula}.

The necessity of the half-angle in the Rodrigues vectors reflects the fact that they actually generate \emph{rotors}, not direct rotations, and hence belong to the underlying spin representation of $\SO^+(3)$ --- a fact made clearer in the context of geometric algebra.









\subsection{In higher dimensions}

In fewer than four dimensions, the $4$-vector $\Ta1\wedge\Ta2 = 0$ appearing in the geometric \x{BCH} formula is trivial, and so \cref{eqn:geometric-BCH} involves only bivector addition and scalar multiplication.
In four dimensions, there is one linearly independent $4$-vector --- the pseudoscalar --- which necessarily commutes with all even multivectors.
However, in more than four dimensions, $4$-vectors do \emph{not} necessarily commute with bivectors, and the assumptions underlying \cref{eqn:arev-and-srev-parts} and hence the main result \eqref{eqn:geometric-BCH} fail.


On the face of it, the \x{BCH} formula \eqref{eqn:geometric-BCH} in the four-dimensional case appears deceptively simple --- it hides complexity in the calculation of the trigonometric functions of arbitrary bivectors,
\begin{fullwidth}
	\begin{align}
		\tanh Ïƒ_i &= Ïƒ - \frac13Ïƒ^3 + \frac{2}{15}Ïƒ^5 + \cdots
	&	&\text{and}
	&	\arctanh Ïƒ_i &= Ïƒ +\frac13Ïƒ^3 + \frac15Ïƒ^5 + \cdots
		\label{eqn:trig-power-series}
	.\end{align}
\end{fullwidth}

In fewer dimensions, $Ïƒ^2$ is a scalar, and so these power series are as easy to compute as their real equivalents.\sidenote{
	If $Ïƒ^2 = N_Ïƒ^2 âˆˆ \RR$, then we have simply $\tanh Ïƒ = (\tanh N_Ïƒ)N_Ïƒ^{-1}Ïƒ$.
}
But in four dimensions, $Ïƒ^2$ is in general a $\qty{0,4}$-multivector (by lemma~\ref{lem:grades-of-square}) and the power series \eqref{eqn:trig-power-series} are more complicated.
However, if $Ïƒ^2 \ne 0$ has a square root $N_Ïƒ = Î± + Î²\vol$ in the scalar--pseudoscalar plane, then one has $Ïƒ = N_Ïƒ\hat{Ïƒ} = \hat{Ïƒ}N_Ïƒ$ where $\hat{Ïƒ} \coloneqq Ïƒ/N_Ïƒ$ so that $\hat{Ïƒ}^2 = 1$.
With a bivector $Ïƒ = N_Ïƒ\hat{Ïƒ}$ expressed in this form, the valuation of a formal power series $f(z) = \sum_{n=1}^\infty f_n z^n$ simplifies to
\begin{align}
\label{eqn:normalised-power-series}
	\text{($f$ even)}&
&	f(Ïƒ) &= \sum_{n = 1}^\infty f_{2n} Ïƒ^{2n}
	= \sum_{n = 1}^\infty f_{2n} N_Ïƒ^{2n}
	= f(N_Ïƒ)
,\\	\text{($f$ odd)}&
&	f(Ïƒ) &= \sum_{n = 1}^\infty f_{2n + 1} Ïƒ^{2n + 1}
	= \sum_{n = 1}^\infty f_{2n} N_Ïƒ^{2n + 1} \hat{Ïƒ}
	= f(N_Ïƒ)\hat{Ïƒ}
.\end{align}
This is especially useful in the case of Minkowski spacetime $\GA(1,3)$ because the scalar--pseudoscalar plane is isomorphic to $\CC$ and square roots always exist (see \cref{sec:invariant-bivector-decomposition}).
From now on, we focus on the special case of Minkowski spacetime, and consider practical and theoretical applications.








\section{\x{BCH} Composition in Spacetime}

Because the geometric \x{BCH} formula is constructed from sums and products of bivectors, it involves only even spacetime multivectors.
Therefore, in numerical applications, it is not necessary to represent the full STA, but only the even subalgebra $\GA[+](1,3) \cong \GA(3)$.

The algebra of physical space $\GA(3)$ admits a faithful complex linear representation by the Pauli spin matrices \cite{baylis1989sta-pauli,lasenby2016ga-unified-language,hestenes2003sta}.
The real dimension of both $\CC^{2Ã—2}$ and $\GA(3)$ is eight, so there is no redundancy in the Pauli representation, so it is convenient for computer implementation.



An even $\GA[+](1,3)$ multivector --- or equivalently, a general $\GA(3)$ multivector --- may be parametrised by four complex scalars $q^Î¼ = \Re(q^Î¼) + i\Im(q^Î¼) âˆˆ \CC$ as
\begin{align}
	A = \Re(q^0) + \Re(q^i)\vs_i + \Im(q^i)\vol\vs_i + \Im(q^0)\vol
,\end{align}
where the $\vs_i$ may be read both as spacetime bivectors $\vs_i \equiv \vg_0\vg_i âˆˆ \GA[+](1,3)$ or as basis vectors of $\GA(3)$ under a space\slash time split.
The Pauli matrices $Ïƒ_i âˆˆ \CC^{2Ã—2}$ form a linear representation of $\GA(3)$ by the association $\vs_i \equiv Ïƒ_i$.
Explicitly, identifying
\begin{align}
	\vs_1 &\equiv \mqty[
		 0&+1\\
		+1& 0\\
	]
&	\vs_2 &\equiv \mqty[
		 0&-i\\
		+i& 0\\
	]
&	\vs_3 &\equiv \mqty[
		+1& 0\\
		 0&-1\\
	]
\end{align}
along with $1 \equiv I$ and $\vol \equiv iI$ where $I$ is the identity matrix, we obtain a representation of the multivector $A$ by a $2 Ã— 2$ complex matrix:
\begin{align}
	\lin A \equiv \mqty[
		q^0 + q^3 & q^1 - iq^2 \\
		q^1 + iq^2 & q^0 - q^3
	]
	\label{eqn:multivector-as-matrix}
.\end{align}






A proper Lorentz transformation $\lin Î› âˆˆ \SO^+(1,3)$ is determined in the $K$ frame by a vector rapidity $\vb Î¾ âˆˆ \RR^3$ and axis-angle vector $\vb Î¸ âˆˆ \RR^3$.
The standard $4Ã—4$ matrix representation of $\lin Î›$ is obtained as the exponential of the generator
\begin{align}
	\mqty[
		 0 &  \vb Î¾^T \\
		\vb Î¾ & Îµ_{ijk}Î¸^k
	] =
	\qty[\begin{array}{llll}
	0 & \phantom{Â±}Î¾^1 & \phantom{Â±}Î¾^2 & \phantom{Â±}Î¾^3 \\
	Î¾^1 & \phantom{Â±}0 & +Î¸^3 & -Î¸^2 \\
	Î¾^2 & -Î¸^3 & \phantom{Â±}0 & +Î¸^1 \\
	Î¾^3 & +Î¸^2 & -Î¸^1 & \phantom{Â±}0
	\end{array}]
	\in \liealg{so}(1,3)
	\label{eqn:lorentz-generator-matrix}
.\end{align}
In the spin representation, the transformation $\lin Î›$ corresponds to a rotor $\rotor L = e^Ïƒ$, and the generating bivector \eqref{eqn:bivector-generator} may be expressed via \cref{eqn:multivector-as-matrix} as the traceless complex matrix
\begin{align}
	\lin Î£ = q^kÏƒ_k = \mqty[
		+q^3 & q^1 - iq^2 \\
		q^1 + iq^2 & -q^3
	]
	\label{eqn:bivector-as-matrix}
,\end{align}
where $q^k \coloneqq \frac12(Î¾^k + iÎ¸^k) âˆˆ \CC$.
% This represents the restriction of \eqref{eqn:multivector-as-matrix} to spacetime bivectors.
Note that, since the square of a spacetime bivector is a $\qty{0,4}$-multivector, its representative matrix $\lin Î£$ squares to a complex scalar multiple of the identity.



Given two generators $Ïƒ_i$ with matrix representations $\lin Î£_i$, the geometric \x{BCH} formula \eqref{eqn:geometric-BCH} reads
\begin{align}
	\lin Î£_3 â‰” \bch{\lin Î£_1}{\lin Î£_2} = \tanh^{-1}\qty(
		\lin{\frac{ T_1 + T_2 + A }{ I + S }}
	)
	\label{eqn:matrix-BCH}
,\end{align}
where $\lin T_i â‰” \tanh \lin Î£_i$.
To efficiently compute $\lin T_i$, make use of the fact that $\lin Î£_i^2 = Î»_i^2\lin I$ is a complex multiple of the identity matrix and evaluate $\lin T_i = (\tanh Î»_i)Î»_i^{-1}\lin Î£_i$.
In the null case $\lin Î£_i^2 = Î» = 0$, we have trivially $\tanh \lin Î£_i = \lin Î£_i = \tanh^{-1} \lin Î£_i$.



The commutator $\lin A â‰” \frac12[\lin T_1, \lin T_2]$ and anti-commutator $\lin S â‰” \frac12\qty{\lin T_1, \lin T_2}$ terms may be efficiently computed by separating the single matrix product $\lin{ Î  â‰” T_1T_2 = A + S }$ into off-diagonal and diagonal components, respectively; i.e.,
\begin{align}
	\lin A_{ij} = (1 - Î´_{ij})\lin Î _{ij}
	\qqtext{and}
	\lin S_{ij} = Î´_{ij}\lin Î _{ij}
.\end{align}
The numerator of \cref{eqn:matrix-BCH} is therefore a matrix with zeros on the diagonal, and the denominator is a complex scalar multiple of the identity, so the argument of $\tanh^{-1}$, call it $\lin M$, is in the form \eqref{eqn:bivector-as-matrix}.
Computing $\tanh^{-1} \lin M$ again simply amounts to
\begin{math}
	\lin Î£_3 = \tanh^{-1} \lin M = (\tanh^{-1} Î»)Î»^{-1}\lin M
\end{math}
where $\lin M^2 = Î»^2\lin I$.

The Lorentz generator in the standard vector representation \eqref{eqn:lorentz-generator-matrix} can then be recovered from $\lin Î£_3$ with the relations $Î¾^k = 2\Re(q^k)$ and $Î¸^k = 2\Im(q^k)$, and the final $\SO^+(1,3)$ vector transformation is its $4Ã—4$ matrix exponential.









\subsection{Relativistic 3-velocities and the Wigner angle}

As an example of its theoretical utility, we shall use the geometric \x{BCH} formula \eqref{eqn:geometric-BCH} to derive the composition law for arbitrary relativistic $3$-velocities.

The innocuous problem of composing relativistic velocities has been called ``paradoxical'' \cite{ungar1989sr-velocity-composition,mocanu1992sr-velocity-composition,visser2011sr-velocity-composition}, owing in part to the fact that \emph{irrotational} boosts are not closed under composition, and that explicit matrix analysis becomes cumbersome.
Of course, in reality there is no paradox, and the full description of the composition of boosts is pedagogically valuable as it highlights aspects of special relativity which differ from spatial intuition.


We may speak of a rotation or boost as being \textdef{pure} relative to the $K$ frame.
Technically, $Ïƒ$ generates a pure rotation (or pure boost) if, under the space\slash time split relative to the $K$ frame, $Ïƒ = \grade[2]{Ïƒ}$ is a pure bivector (or a pure vector) in $\GA(3)$.
A pure rotation or pure boost relative to $K$ is \emph{not} pure in all other frames.

The restriction of the \x{BCH} formula to pure boosts is not as simple as the restriction to rotations \eqref{eqn:rodrigues-formula}, because pure boosts do not form a closed subgroup of $\SO^+(1,3)$ as pure rotations do.
Instead, the composition of two pure boosts $\rotor B_i$ is a pure boost composed with a pure rotation (or vice versa),
\begin{align}
	\rotor B_1\rotor B_2 = \rotor B\rotor R
	\label{eqn:boost-boost-makes-boost-rotation}
.\end{align}
The direction of the boost $\rotor B$ lies within the plane defined by the boost directions of $\rotor B_1$ and $\rotor B_2$, and $\rotor R$ is a rotation through this plane by the \emph{Wigner angle} \cite{visser2011sr-velocity-composition}.
Applying \cref{eqn:geometric-BCH} to this case immediately yields formulae for the resulting boost and rotation.\sidenote{
	These results are equivalent to those in \cite{berry2020quat-sr} which are formulated using complexified quaternions.
}



For ease of algebra, we conduct the following analysis under a space\slash time split with respect to the $K$ frame.
Under this split, a pure boost $\rotor B$ is generated by an $\RR^3$ vector $\frac{\vb Î¾}{2}$, and a pure rotation $\rotor R$ is generated by an $\RR^3$ bivector $\fracÎ¸2\hat{r}$.
Here, $\vb Î¾ âˆˆ \GA[1](3)$ is the \emph{vector rapidity}, related to the velocity by $\vb v/c = \vb Î² = \tanh \vb Î¾$, and the rotation is through an angle $Î¸$ in the plane spanned by the bivector $\hat{r} âˆˆ \GA[2](3)$.
\Cref{eqn:geometric-BCH} with two pure boosts $\vb Î¾_1$ and $\vb Î¾_2$ is
\begin{align}
	\tanh(\bch{\frac{\vb Î¾_1}{2}}{\frac{\vb Î¾_2}{2}})
	= \frac{ğ’˜_1 + ğ’˜_2 + ğ’˜_1 âˆ§ ğ’˜_2}{1 + ğ’˜_1â‹…ğ’˜_2}
	\label{eqn:boost-boost}
\end{align}
where $ğ’˜_i â‰” \tanh\frac{\vb Î¾_i}{2}$ are the \emph{relativistic half-velocities}, also defined in \cite{berry2020quat-sr,berry2021quat-sr}.
The generator \eqref{eqn:boost-boost} has vector and bivector (namely $ğ’˜_1 âˆ§ ğ’˜_2$) parts, indicating that the Lorentz transformation it describes is indeed some combination of a boost and a rotation.


Similarly, for an arbitrary pure boost and pure rotation,
\begin{align}
	\tanh(\bch{\frac{\vb Î¾}2}{\fracÎ¸2\hat{r}})
	= \frac{ğ’˜ + Ï + \frac12[ğ’˜, Ï]}{1 + ğ’˜\wedge Ï}
	\label{eqn:boost-rotation}
\end{align}
where $Ï â‰” \tanh \frac{Î¸\hat{r}}2 = \hat{r}\tan\frac Î¸2$ is a bivector.
In general, \cref{eqn:boost-rotation} has vector, bivector \emph{and} pseudoscalar parts (the commutator $\frac12[ğ’˜, Ï] = \grade[1]{ğ’˜Ï} + ğ’˜ \wedge Ï$ and the denominator both have grade-three part $ğ’˜\wedge Ï$).
However, \cref{eqn:boost-boost,eqn:boost-rotation} are equal by supposition of \cref{eqn:boost-boost-makes-boost-rotation}.
By comparing parts of equal grade, we deduce the pseudoscalar part of \cref{eqn:boost-rotation} is zero.
This requires $ğ’˜\wedge Ï = 0$ or, equivalently, that $ğ’˜$ lies in the plane defined by $Ï$ --- meaning the resulting boost is coplanar with the Wigner rotation as expected.
Hence, for a coplanar boost and rotation, \cref{eqn:boost-rotation} is simply
\begin{align}
	\tanh(\bch{\frac{\vb Î¾}2}{\fracÎ¸2\hat{r}})
	= ğ’˜ + Ï + ğ’˜Ï
	\label{eqn:boost-rotation-coplanar}
.\end{align}
The term $ğ’˜Ï = \grade[1]{ğ’˜Ï} = -Ïğ’˜$ is a vector orthogonal to $ğ’˜$ in the plane defined by $Ï$.




Equating the bivector parts of \cref{eqn:boost-boost,eqn:boost-rotation-coplanar} determines the rotation
\begin{align}
	Ï &= \frac{ğ’˜_1 \wedge ğ’˜_2}{1 + ğ’˜_1 Â· ğ’˜_2}
,&	&\text{implying}
&	Î¸ = 2\tan^{-1}\qty(\frac{w_1w_2\sinÏ•}{1 + w_1w_2\cosÏ•})
\end{align}
where $Ï•$ is the angle between the two initial boosts (in the $K$ frame).
The angle $Î¸$ is precisely the Wigner angle.
Equating the vector parts determines the boost
\begin{align}
	ğ’˜ &= \frac{ğ’˜_1 + ğ’˜_2}{1 + ğ’˜_1â‹…ğ’˜_2}(1 + Ï)^{-1}
,\end{align}
noting that $ğ’˜_i$ and $Ï$ do not commute.
Substituting $Ï$ leads to the remarkably succinct composition law
\begin{math}
	ğ’˜ = (ğ’˜_1 + ğ’˜_2)(1 + ğ’˜_1ğ’˜_2)^{-1}
\end{math}
exhibited in \cite{berry2020quat-sr}, with the final relativistic velocity being $\vb Î² = \tanh \vb Î¾ = \tanh (2\tanh^{-1} ğ’˜)$.
