
\chapter{Integral Theorems}


\section{Stokes' theorem for exterior calculus}

\begin{theorem}[Stokes' theorem in $\RR^n$]
	\label{thm:flat-stokes}
	If $R âŠ† \RR^n$ is a compact $k$-dimensional hypersurface with boundary $âˆ‚R$, then a smooth differential form $Ï‰ âˆˆ \forms[k - 1](R)$ satisfies
	\begin{align}
		\label{eqn:stokes}
		\int_R \dd Ï‰ = \int_{âˆ‚R} Ï‰
	.\end{align}
\end{theorem}
\begin{proof}
	Since $R$ is a $k$-dimensional region with boundary, every point $x âˆˆ R$ has a neighbourhood diffeomorphic to a neighbourhood of the origin in either $\RR^k$ or $H^k â‰” [0, âˆ) âŠ• \RR^{k - 1}$, depending on whether $x$ is an interior point or a boundary point, respectively.

	\begin{marginfigure}
		\includefigure[\columnwidth]{stokes-theorem}
		\caption{
			Neighbourhoods in $R$ are diffeomorphic either to interior balls or boundary half-balls.
		}
		\label{fig:stokes-theorem}
	\end{marginfigure}

	Let $\set{U_i}$ be a cover of $R$ consisting of such neighbourhoods.
	Since $R$ is compact, we may assume $\bigcup_{i=1}^N \set{U_i} = R$ to be a finite covering.
	Thus, we have finitely many maps $h_i : U_i â†’ X$ where $X$ is either $\RR^k$ or the half-space $H^k$, where $U_i \cong h_i(U_i)$ are diffeomorphic (see \cref{fig:stokes-theorem}).

	Finally, let $\set{Ï•_i : R â†’ [0, 1]}$ be a partition of unity subordinate to $\set{U_i}$, so that $\set{x âˆˆ R | Ï•_i(x) > 0} âŠ† U_i$ and $Ï‰ = \sum_{i=1}^N Ï•_iÏ‰$.
	We need only prove the equality \eqref{eqn:stokes} for each $Ï‰_i â‰” Ï•_iÏ‰$, and the full result follows be linearity.
	
	The form $h_i^*Ï‰_i âˆˆ \forms[k - 1](X)$ can be written with respect to canonical coordinates of $X$ as
	\begin{align}
		h_i^*Ï‰_i = \sum_{j=1}^k f_j (-1)^{j - 1} \dd x^{1\cdots\hat{j}\cdots k}
	\end{align}
	using the multi-index notation $\dx^{\etc{i_\i}{}k} â‰¡ \etc{\dx^{i_\i}}âˆ§k$, where the hat denotes an omitted term.
	The factor of $(-1)^{j - 1}$ gives the $(k - 1)$-form the boundary orientation induced by the volume form $\dx^{\etc\i{}k}$ for convenience.
	Since pullbacks commute with $\dd$,
	\begin{align}
		h^*\ddÏ‰_i = \dd(h_i^*Ï‰_i) = \sum_{j=1}^k \pdv{f_j}{x^j} \dd x^{1\cdots n}
	.\end{align}
	There are then two cases to consider.
	\begin{itemize}
		\item \emph{Interior case.}
		If $h_i : U_i â†’ \RR^k$, then the right-hand side of \cref{eqn:stokes} vanishes because $Ï‰_i$ is zero outside the neighbourhood $U_i âŠ‚ R$ which nowhere meets the boundary $âˆ‚R$.
		\begin{align}
			\int_{âˆ‚R} Ï‰_i = \int_{âˆ‚U_i} Ï‰_i = \int_âˆ… Ï‰_i = 0
		\end{align}
		The left-hand side evaluates to
		\begin{align}
		  	\int_R \dd Ï‰_i
		  	&= \int_X \dd (h_i^*Ï‰_i)
		  	= \int_{\RR^k} \sum_{j=1}^k \pdv{f_j}{x^j} \dd x^{1\cdots n}
		\\	&= \underbrace{\etc{\int_{-âˆ}^{+âˆ}}{}{}}_k \sum_{j=1}^k \pdv{f_j}{x^j} \etc{dx^\i}{}{k}
		\\	&= \underbrace{\etc{\int_{-âˆ}^{+âˆ}}{}{}}_{k - 1} \sum_{j=1}^k \eval{f_j}_{x^j=-âˆ}^{+âˆ} (-1)^{j-1} dx^1\cdots\widehat{dx^j}\cdots dx^k
		  	= 0
		,\end{align}
		which vanishes because $h_i^*Ï‰_i$, and hence the $f_j$, vanish outside the neighbourhood $h_i(U_i) âŠ‚ \RR^k$.

	\item \emph{Boundary case.}
	If $h_i : U_i â†’ H^k$, then the boundary $âˆ‚U_i âŠ‚ âˆ‚R$ is mapped onto the hyperplane $âˆ‚H^k = \set{(0, \etc[2]{x^\i},k) | x^j âˆˆ \RR}$.
	Thus, $dx^1 = 0$ on this boundary, and the right-hand side of \cref{eqn:stokes} becomes
	\begin{align}
		\int_{âˆ‚R}Ï‰_i
		&= \int_{âˆ‚U_i} h_i^*Ï‰_i
		= -\int_{\RR^{k - 1}} f_1 \etc[2]{dx^\i}{}k
	\\	&= -\underbrace{\etc{\int_{-âˆ}^{+âˆ}}{}{}}_{k - 1} f_1(0, \etc[2]{x^\i},k) \etc[2]{dx^\i}{}k
	.\end{align}
	The factor of $-1$ comes from the induced orientation of the boundary $âˆ‚H^k$, which is outward-facing, so in the \emph{negative} $x^1$ direction.
	For the left-hand side of \cref{eqn:stokes},
	\begin{align}
		\int_R \dd Ï‰_i
		&= \int_{H^k} h_i^*\ddÏ‰_i
		= \int_0^âˆ \etc{\int_{-âˆ}^{+âˆ}}{}{} \sum_{j=1}^k \pdv{f_j}{x^j} \etc{dx^\i}{}k
	\intertext{
		All terms $\pdv{f_j}{x^j}dx^j$ in the sum for $j > 1$ integrate to boundary terms $x_j â†’ Â±âˆ$ where $f_j$ vanishes.
		This leaves the single term from the integration of $dx^1$,
	}
		&= -\etc{\int_{-âˆ}^{+âˆ}}{}{} \eval{f_1}_{x^1=0}^âˆ \etc[2]{dx^\i}k
	.\end{align}

	\end{itemize}

	Thus, we have equality for all $Ï‰_i$, so
	\begin{align}
		\int_R \dd Ï‰ = \sum_{i=1}^N \int_R \dd Ï‰_i = \sum_{i=1}^N \int_{âˆ‚R} Ï‰_i = \int_{âˆ‚R} Ï‰
	\end{align}
	by linearity.
\end{proof}

\section{Fundamental theorem of geometric calculus}

\begin{theorem}
	Let $f(ğ’™)$ be a multivector field.
	The vector derivative is
	\begin{align}
		\vd f(ğ’™) = \lim_{|â„›| â†’ 0} \frac1{|â„›|\vol} \oint_{âˆ‚â„›} \bd S f
	,\end{align}
	where $â„›$ is a volume containing $ğ’™$ with boundary $âˆ‚â„›$ and volume $|â„›| = \int_â„› \bd V$.
	The limit is taken as the volume $â„›$ shrinks to the point $ğ’™$.
\end{theorem}
Note that the integrand $\bd S f$ is the geometric product between the hypersurface element and the field.
\begin{proof}
	It will suffice to prove the case where $â„›$ is a box shape; arbitrary regions can be approximated via tessellation in the limit of vanishing voxel size.

	Let $B_Îµ = \set{x^i\ve_i | x^i âˆˆ [-Îµ, +Îµ]}$ denote the $n$-dimensional cube of diameter $2Îµ$ centred at the origin.
	If the surface $âˆ‚B_Îµ$ is oriented outward, then the face in the $+\ve^k$ direction is orientated like the $(n-1)$-blade $\vol \ve^k = (-1)^{n-k}\etcskip{\ve_\i}âˆ§kn$.
	Upon this face the infinitesimal surface element is
	\begin{align}
		% \bd^{(k)}x = \vol \ve^k dx^1\cdots\widehat{dx^k}\cdots dx^n
		\bd^{(k)}x = \vol \ve^k \etcskip{dx^\i}{}{k}{n}
	,\end{align}
	while the opposing face has surface element $-\bd^{(k)}x$.

	Consider the integral of $f$ over the surface $âˆ‚B_Îµ$, split into a sum of $n$ surface integrals over each pair of opposing faces.
	The $k$th pair are the surfaces $\set{x^i\ve_i Â± Îµ\ve_k | x^i âˆˆ [-Îµ, +Îµ], i â‰  k}$ where $i$ sums over axes \emph{other} than $k$.
	Hence, we have
	\begin{align}
		\oint_{âˆ‚B_Îµ} \bd S f = \sum_{k=1}^n \int_{[-Îµ, +Îµ]^{n-1}} \bd^{(k)}x \, \qty(f(x^i\ve_i + Îµ\ve_k) - f(x^i\ve_i - Îµ\ve_k))
	,	\quad(i â‰  k)
	.\end{align}
	By series expanding $f$ in each $x^i$, and then in $Îµ$, obtain
	\begin{align}
		f(x^i\ve_i Â± Îµ\ve_k) &= f(Â±Îµ\ve_k) + x^i âˆ‚_{\ve^i} (f(0) Â± Îµâˆ‚_{\ve^k} f(0))
	.\end{align}
	Since $|x^i| â‰¤ Îµ$, the last term is $ğ’ª(Îµ^2)$, and difference in the integrand is hence
	\begin{align}
		f(x^i\ve_i + Îµ\ve_k) - f(x^i\ve_i - Îµ\ve_k)
		&= f(Îµ\ve_k) - f(-Îµ\ve_k) + ğ’ª(Îµ^2)
	\\	&= 2Îµâˆ‚_{\ve^k}f(0) + ğ’ª(Îµ^2)
	.\end{align}
	Therefore, after pulling constants outside the integrals, we have
	\begin{align}
		\oint_{âˆ‚B_Îµ} \bd S f
		&â‰ˆ \sum_{k=1}^n 2Îµ \, âˆ‚_{\ve^k} f(0) \int_{[-Îµ, +Îµ]^{n-1}} \bd^{(k)}x
	\end{align}
	to order $ğ’ª(Îµ^2)$.
	The integrands each evaluate to the area $(2Îµ)^{n-1}$, giving
	\begin{align}
		\oint_{âˆ‚B_Îµ} \bd S f
		â‰ˆ (2Îµ)^n \vol\ve^k âˆ‚_{\ve^k} f(0)
		= |B_Îµ|\vol \, \vd f(0)
	,\end{align}
	to order $ğ’ª(Îµ^2)$, which becomes exact in the limit,
	\begin{align}
		\label{eqn:vd-int-form}
		\vd f(0) = \lim_{Îµ â†’ 0} \frac1{|B_Îµ|\vol} \oint_{âˆ‚B_Îµ} \bd S f
	.\end{align}

	By translation, $f(ğ’™) â†¦ f'(ğ’™) = f(ğ’™ - ğ’–)$, we obtain the integral form of $\vd f(ğ’–)$ evaluated at an arbitrary position $ğ’–$.
\end{proof}

\begin{theorem}
	For an $n$-dimensional region $â„›$ with boundary $âˆ‚â„›$, and a multivector field $f(ğ’™)$,
	\begin{align}
		\int_â„› \bd V \, \vd f = \oint_{âˆ‚â„›} \bd S f
	,\end{align}
	where $\bd V$ denotes an $n$-blade volume element, and $\bd S$ an $(n - 1)$-blade surface element, and where juxtoposition is the geometric product. 
\end{theorem}
\begin{proof}
	An arbitray volume $â„›$ with boundary $âˆ‚â„›$ can be approximated as tessellated boxes of arbitrily small size.\sidenote{
		It is not neccesary that the surface area of the approximation converge to $|âˆ‚â„›|$.
	}
	Suppose $â„›$ is approximated by a regular lattice of $N$ boxes of radius $Îµ$.
	Consider the sum of $\vd f$ over the lattice points, weighted by volume.
	From \cref{eqn:vd-int-form} this can be written in terms a sum of surface integrals,
	\begin{align}
		\sum_{i=1}^N |B_i|\vol \, \vd f(ğ’™_i) = \sum_{i=1}^N \oint_{âˆ‚B_i} \bd S f
	.\end{align}
	Note that interior faces of the boxes come in oppositely-oriented pairs, so that surface integrals over interior faces cancel.
	Therefore, the result is obtained in the continuous limit $N â†’ âˆ$.
\end{proof}

\todo{Comment on how this generalizes Stokes' theorem.}