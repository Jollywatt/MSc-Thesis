\usepackage{mathtools}


\renewcommand{\op}[1]{{\operatorname{#1}}}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}

\DeclareMathOperator{\arctanh}{arctanh}
% trig
\newcommand{\Co}{\mathrm{C}_}
\newcommand{\Si}{\mathrm{S}_}
\newcommand{\Ta}{\mathrm{T}_}



% Set builder notation (usage: `\set{a | P(a)}` or `\set[\big]{1, 2}`)
\usepackage{xparse}
\usepackage{ifthen}
\DeclarePairedDelimiterX{\setdelim}[1]{\{}{\}}{\setargs{#1}}
\NewDocumentCommand{\setargs}{>{\SplitArgument{1}{|}}m}{\setargsaux#1}
\NewDocumentCommand{\setargsaux}{mm}{\IfNoValueTF{#2}{#1}{#1\nonscript\:\delimsize\vert\allowbreak\nonscript\:\mathopen{}#2}}%
\newcommand{\set}[2][*]{\ifthenelse{\equal{\detokenize{#1}}{*}}{\setdelim*{#2}}{\setdelim[#1]{#2}}}


% quaternions
\newcommand{\ii}{\vb{\skew{1}\hat{\clipbox{0pt 0pt 0pt 2.7pt}{$i$}} }}
\newcommand{\jj}{\vb{\skew{3}\hat{\clipbox{0pt 0pt 0pt 2.7pt}{$j$}} }}
\newcommand{\kk}{\vb{\hat k}}


% basis vectors
\renewcommand{\vb}[1]{\symbfit{#1}}
\newcommand{\ve}{\vb{e}}
\newcommand{\vg}{\vb{Œ≥}}
\newcommand{\vs}{\vec{œÉ}}
\newcommand{\dx}{\dd x}
\newcommand{\‚àÇ}{\symbf{‚àÇ}}

\newcommand{\spanof}{\op{span}\set}

\renewcommand{\ip}[1]{\left‚ü® #1 \right‚ü©}

% special structures
\newcommand{\manif}{\mathcal}	% manifold
\newcommand{\cat}{\mathbf}	% category
\newcommand{\liealg}{\mathfrak}	% Lie algebra
\newcommand{\lin}{\mathrm}	% linear map
\newcommand{\rotor}{\mathscr}	% geometric algebra rotors

% fields
\usepackage{dsfont}
\newcommand{\FF}{\mathds{F}}
\newcommand{\RR}{\mathds{R}}
\newcommand{\CC}{\mathds{C}}
\newcommand{\HH}{\mathds{H}}
\newcommand{\ZZ}{\mathds{Z}}
\newcommand{\NN}{\mathds{N}}

% groups
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\GL}{GL}

% quotient structure
\newcommand{\quot}[3][*]{
	\if*#1
		\left. #2 \middle/ #3 \right.
	\else
		#2 #1/ #3
	\fi
}

% generator
\newcommand{\gen}[1]{\set{\!\set{#1}\!}}

% transpose superscript
\newcommand{\transpose}{^{\mkern-1.5mu\mathsf{T}}}


% path-ordered exponential
\newcommand{\Pexpl}[1][]{\accentset{‚Üê}{\mathds{P}}_{#1}\exp}
\newcommand{\Pexpr}[1][]{\accentset{‚Üí}{\mathds{P}}_{#1}\exp}


% algebras
\newcommand{\TA}[2][]{{#2}^{‚äó#1}}
\usepackage{scalerel}
\newcommand{\EA}[1][]{\scalerel*{\wedge}{V}^{#1}}
\newcommand{\SA}[1][\,]{ùíÆ^{\!#1}}
\newcommand{\GA}[1][]{ùí¢_{#1}}

\newcommand{\forms}[1][]{\op{Œ©}^{#1}}


% shortcuts

% easy dotted sequence: \etc{ùíñ_{\i}}{‚äó}{k} ‚Üí ùíñ_1 ‚äó ¬∑¬∑¬∑ ‚äó ùíñ_k
\newcommand{\etc}[4][1]{
	{\def\i{#1} #2}
	#3 \if,#3 \dots \else \cdots \fi #3
	{\def\i{#4} #2}
}
\newcommand{\etcskip}[5][1]{
	{\def\i{#1} #2}
	#3 \if,#3 \dots \else \cdots \fi #3
	{\def\i{#4} \widehat{#2}}
	#3 \if,#3 \dots \else \cdots \fi #3
	{\def\i{#5} #2}
}
\newcommand{\etcmid}[5][1]{
	{\def\i{#1} #2}
	#4 \if,#4 \dots \else \cdots \fi #4
	{#3}
	#4 \if,#3 \dots \else \cdots \fi #4
	{\def\i{#5} #2}
}


\makeatletter
\newcommand{\sig}[1]{(\@tfor\elem:=#1\do{{\elem}})}
\makeatother




% geometric algebra
\DeclarePairedDelimiter{\angbr}{‚ü®}{‚ü©}
\newcommand{\grade}[2][]{\angbr*{#2}_{#1}}

\newcommand{\vol}{\mathds{I}}

\newcommand{\rev}[1]{#1^\dagger}
\newcommand{\revsign}[1]{s_{#1}}

\newcommand{\invol}[1]{#1^\star}

\newcommand{\bch}[2]{#1 \odot #2}

% self-reverse and anti-self-reverse projections
\newcommand{\srev}[1]{\qty{\!\!\qty{#1}\!\!}}
\newcommand{\arev}[1]{\qty[\!\qty[#1]\!]}

% "fat dot" product
% https://tex.stackexchange.com/a/235120/105570
\makeatletter
\newcommand*\fatdot{\mathpalette\bigcdot@{.8}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

\newcommand{\wedot}{\mathrel{\ooalign{\hfil$‚àß$\hfil\cr\hfil$.$\hfil}}}

% left and right contractions
\newcommand{\lcontr}{\mathrel{\rfloor}}
\newcommand{\rcontr}{\mathrel{\lfloor}}






% DIFFERENTIAL GEOMETRY


% topological sphere
\newcommand{\Sphere}{\mathscr{S}}


% tangent bundle, vertical bundle
\DeclareMathOperator{\TT}{T}
\DeclareMathOperator{\VV}{V}

% section of bundle
\DeclareMathOperator{\secs}{Œì}

% injection, surjection, bijection
\newcommand{\inject}{\hookrightarrow} % ‚Ü™Ô∏é
\newcommand{\surject}{\twoheadrightarrow} % ‚Ü†
\usepackage{trimclip}
\newcommand{\biject}{\mathrel{%
\mathrlap{\clipbox*{0 -1ex {0.5\width} {\height}}{$\inject$}}%
\surject}}

% fibre bundle A ‚Ü™Ô∏é B ‚Ü† C
\newcommand{\fibrebundle}[4][]{#2 \inject #3 \overset{#1}{\surject} #4}


% transport operator
\newcommand{\trans}{\operatorname{trans}\displaylimits}


% derivatives
\DeclareMathOperator{\DD}{D}
\newcommand{\vd}{\symbf{‚àÇ}}
\newcommand{\bd}{\symbfup{d}}

% explicit differential form
\usepackage{accents}
\newcommand{\df}[1]{\underaccent{\sim}{#1}}